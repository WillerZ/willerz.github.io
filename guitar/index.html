<!DOCTYPE html>
<html>
    <head>        
        <!-- Google tag (gtag.js) -->
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}

            // Set consent to 'denied'
            // I don't want to un-deny these for anyone, so no banner.
            gtag('consent', 'default', {
                'ad_storage': 'denied',
                'ad_user_data': 'denied',
                'ad_personalization': 'denied',
                'analytics_storage': 'denied'
            });
            gtag('js', new Date());

            gtag('config', 'G-3HVY4J2C28');
        </script>
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-3HVY4J2C28"></script>
        <!-- End of Google tag (gtag.js) -->
        <link rel="modulepreload" href="./worker.js">
        <link rel="modulepreload" href="./deps/openscad-2026.02.01/openscad.js">
        <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
        <link rel="shortcut icon" href="/favicon.ico" />
        <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
        <link rel="manifest" href="/site.webmanifest" />
        <title>Guitar</title>
    </head>
    <body>
        <label for="body-select">Choose the body style:</label>
        <select name="body" id="body-select">
            <option value="batlike">Bat-like</option>
        </select><br>
        <label for="neckSocket-select">Choose the neck socket fitment:</label>
        <select name="neckSocket" id="neckSocket-select">
            <option value="tool/neck/strat.3MF">Strat</option>
            <option value="tool/neck/tele.3MF">Tele</option>
        </select><br>
        <label for="neckPickup-select">Choose the neck pickup type:</label>
        <select name="neckPickup" id="neckPickup-select">
            <option value="">None</option>
            <option value="tool/pickup/neck/humbucker.3MF">Humbucker</option>
        </select><br>
        <label for="middlePickup-select">Choose the middle pickup type:</label>
        <select name="middlePickup" id="middlePickup-select">
            <option value="">None</option>
        </select><br>
        <label for="bridgePickup-select">Choose the bridge pickup type:</label>
        <select name="bridgePickup" id="bridgePickup-select">
            <option value="">None</option>
            <option value="tool/pickup/bridge/humbucker.3MF">Humbucker</option>
        </select><br>
        <label for="bridge-select">Choose the bridge type:</label>
        <select name="bridge" id="bridge-select">
            <option value="tool/bridge/musiclily-ultra.3MF">Musiclily Ultra 52.5mm Hardtail</option>
        </select><br>
        <input id="calculateButton" type="button" value="Build my Guitar"></input><br>
        <div id="output3mf"></div>
        <script type="module">
            const cadWorker = new Worker('./worker.js', {type:"module"});

            const bodies = {
                'batlike': [
                        "body/batlike.3MF",
                        "body/batlike-guard.3MF",
                        "body/batlike-cover.3MF",
                    ],
            };

            cadWorker.onmessage = (msg) => {
                document.getElementById("output3mf").innerHTML = msg.data.join("<br>");
                document.getElementById("output3mf").firstElementChild.addEventListener("click", () => {
                    gtag('event', 'dl_guitar', {
                        'bodyStyle': document.getElementById("body-select").value,
                        'neckSocket': document.getElementById("neckSocket-select").value,
                        'neckPickup': document.getElementById("neckPickup-select").value,
                        'middlePickup': document.getElementById("middlePickup-select").value,
                        'bridgePickup': document.getElementById("bridgePickup-select").value,
                        'bridge': document.getElementById("bridge-select").value
                    }); 
                });
            };

            document.getElementById("calculateButton").addEventListener("click", () => {
                gtag('event', 'build_guitar', {
                    'bodyStyle': document.getElementById("body-select").value,
                    'neckSocket': document.getElementById("neckSocket-select").value,
                    'neckPickup': document.getElementById("neckPickup-select").value,
                    'middlePickup': document.getElementById("middlePickup-select").value,
                    'bridgePickup': document.getElementById("bridgePickup-select").value,
                    'bridge': document.getElementById("bridge-select").value
                });
                cadWorker.postMessage({
                    bodies: bodies[document.getElementById("body-select").value],
                    tools: [
                        document.getElementById("neckSocket-select").value,
                        document.getElementById("neckPickup-select").value,
                        document.getElementById("middlePickup-select").value,
                        document.getElementById("bridgePickup-select").value,
                        document.getElementById("bridge-select").value,
                    ].filter(Boolean)
                });
            });
        </script>
    </body>
</html>